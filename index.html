<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Familiada - Panel Sterowania Rundami</title>
    <style>
        :root {
            --blue: #002266;
            --gold: #ffcc00;
            --green: #27ae60;
            --red: #e74c3c;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: #121212;
            color: white;
            display: flex;
            justify-content: center;
            padding: 20px;
            margin: 0;
        }

        #game-container {
            width: 100%;
            max-width: 900px;
            background: var(--blue);
            border: 10px solid #333;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 50px rgba(0,0,0,0.5);
        }

        /* Punkty i Drużyny */
        .header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .team {
            background: #001133;
            border: 3px solid #444;
            padding: 15px;
            text-align: center;
            width: 30%;
            border-radius: 10px;
        }

        .team.active { border-color: var(--green); box-shadow: 0 0 15px var(--green); }
        .score { font-size: 2.5rem; color: var(--gold); font-weight: bold; }

        .bank-area {
            text-align: center;
            border: 2px dashed var(--gold);
            padding: 10px;
            border-radius: 10px;
        }

        /* Tablica i Pytanie */
        .question {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            text-align: center;
            font-size: 1.4rem;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .board {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }

        .slot {
            background: #001a4d;
            border: 1px solid var(--gold);
            height: 50px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 15px;
            font-size: 1.1rem;
            text-transform: uppercase;
        }

        .revealed { background: #0044cc; color: var(--gold); border-width: 2px; }
        .missed { color: #666; border-color: #333; }

        /* Błędy */
        #strikes {
            font-size: 4rem;
            color: var(--red);
            text-align: center;
            min-height: 80px;
            letter-spacing: 10px;
        }

        /* Kontrolki */
        .controls { display: flex; gap: 10px; margin-bottom: 20px; }
        input { flex: 1; padding: 15px; font-size: 1.2rem; border-radius: 5px; border: none; }
        button { padding: 15px 20px; cursor: pointer; font-weight: bold; border-radius: 5px; border: none; }
        
        .btn-ok { background: var(--gold); color: black; }
        .btn-swap { background: #9b59b6; color: white; }

        /* Zarządzanie Rundą */
        #round-actions {
            background: rgba(0,0,0,0.5);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            display: none; /* Ukryte w trakcie gry */
        }

        .btn-give { background: var(--green); color: white; margin: 5px; }
        .btn-next { background: #3498db; color: white; display: none; margin-top: 10px; width: 100%; font-size: 1.5rem; }
    </style>
</head>
<body>

<div id="game-container">
    <div class="header">
        <div id="team1-box" class="team active">
            DRUŻYNA 1
            <div id="score1" class="score">0</div>
        </div>
        <div class="bank-area">
            BANK<br>
            <span id="bank-val" class="score" style="font-size: 1.8rem;">0</span>
        </div>
        <div id="team2-box" class="team">
            DRUŻYNA 2
            <div id="score2" class="score">0</div>
        </div>
    </div>

    <div id="question-display" class="question">Ładowanie rundy...</div>

    <div id="board" class="board"></div>

    <div id="strikes"></div>

    <div class="controls" id="game-inputs">
        <input type="text" id="ans-input" placeholder="Wpisz odpowiedź...">
        <button class="btn-ok" onclick="checkAns()">ZATWIERDŹ</button>
        <button class="btn-swap" onclick="toggleTeam()">ZMIANA DRUŻYNY</button>
    </div>

    <!-- Panel po rundzie -->
    <div id="round-actions">
        <p id="round-msg">Runda zakończona! Komu przyznać bank?</p>
        <button class="btn-give" onclick="assignPoints(1)">Drużyna 1</button>
        <button class="btn-give" onclick="assignPoints(2)">Drużyna 2</button>
        <button class="btn-next" id="next-round-btn" onclick="goToNextRound()">NASTĘPNA RUNDA ➔</button>
    </div>
</div>

<script>
    const db = [
        { q: "Więcej niż jedno zwierzę?", a: [["Owca", 45], ["Lama", 25], ["Stado", 15], ["Para", 10]] },
        { q: "Część twarzy?", a: [["Nos", 40], ["Oczy", 30], ["Usta", 20], ["Czoło", 5]] },
        { q: "Rodzaj pieczywa?", a: [["Chleb", 50], ["Bułka", 30], ["Rogal", 10], ["Bagietka", 5]] },
        { q: "Co jest zimne?", a: [["Lód", 45], ["Śnieg", 25], ["Woda", 15], ["Lody", 10]] },
        { q: "Kolor na flagę Polski?", a: [["Biały", 50], ["Czerwony", 50]] },
        { q: "Napój alkoholowy?", a: [["Piwo", 40], ["Wino", 30], ["Wódka", 20], ["Szampan", 5]] },
        { q: "Miesiąc na literę 'L'?", a: [["Lipiec", 40], ["Luty", 35], ["Listopad", 20]] },
        { q: "Przedmiot w łazience?", a: [["Szczoteczka", 35], ["Mydło", 25], ["Ręcznik", 20], ["Lustro", 15]] },
        { q: "Drzewo iglaste?", a: [["Sosna", 40], ["Świerk", 30], ["Jodła", 20], ["Modrzew", 5]] },
        { q: "Imię żeńskie na 'A'?", a: [["Anna", 45], ["Alicja", 25], ["Agata", 15], ["Agnieszka", 10]] }
    ];

    let round = 0, score1 = 0, score2 = 0, bank = 0, strikes = 0, revealed = 0, activeTeam = 1;

    function initRound() {
        const data = db[round];
        document.getElementById('question-display').innerText = `RUNDA ${round+1}: ${data.q}`;
        document.getElementById('board').innerHTML = '';
        document.getElementById('strikes').innerText = '';
        document.getElementById('round-actions').style.display = 'none';
        document.getElementById('next-round-btn').style.display = 'none';
        document.getElementById('game-inputs').style.opacity = '1';
        bank = 0; strikes = 0; revealed = 0;
        document.getElementById('bank-val').innerText = 0;

        data.a.forEach((item, i) => {
            const div = document.createElement('div');
            div.className = 'slot';
            div.id = `s-${i}`;
            div.innerHTML = `<span>${i+1}. ....................</span><span>--</span>`;
            document.getElementById('board').appendChild(div);
        });
    }

    function checkAns() {
        const inp = document.getElementById('ans-input');
        const val = inp.value.trim().toLowerCase();
        inp.value = '';
        if (!val) return;

        let found = false;
        db[round].a.forEach((ans, i) => {
            if (ans[0].toLowerCase() === val) {
                const s = document.getElementById(`s-${i}`);
                if (!s.classList.contains('revealed')) {
                    s.classList.add('revealed');
                    s.innerHTML = `<span>${i+1}. ${ans[0]}</span><span>${ans[1]}</span>`;
                    bank += ans[1];
                    document.getElementById('bank-val').innerText = bank;
                    revealed++;
                    found = true;
                } else found = true;
            }
        });

        if (!found) {
            strikes++;
            document.getElementById('strikes').innerText = 'X '.repeat(strikes);
            if (strikes >= 3) finishRoundView();
        } else if (revealed === db[round].a.length) {
            finishRoundView();
        }
    }

    function finishRoundView() {
        // Pokaż panel przyznawania punktów i odkryj brakujące odpowiedzi
        document.getElementById('round-actions').style.display = 'block';
        document.getElementById('game-inputs').style.opacity = '0.3';
        db[round].a.forEach((ans, i) => {
            const s = document.getElementById(`s-${i}`);
            if (!s.classList.contains('revealed')) {
                s.className = 'slot missed';
                s.innerHTML = `<span>${i+1}. ${ans[0]}</span><span>${ans[1]}</span>`;
            }
        });
    }

    function assignPoints(team) {
        if (team === 1) score1 += bank;
        else score2 += bank;
        document.getElementById('score1').innerText = score1;
        document.getElementById('score2').innerText = score2;
        
        document.getElementById('round-msg').innerText = "Punkty przyznane. Możesz przejść dalej.";
        document.querySelectorAll('.btn-give').forEach(b => b.style.display = 'none');
        document.getElementById('next-round-btn').style.display = 'block';
    }

    function goToNextRound() {
        round++;
        if (round < db.length) {
            document.querySelectorAll('.btn-give').forEach(b => b.style.display = 'inline-block');
            document.getElementById('round-msg').innerText = "Runda zakończona! Komu przyznać bank?";
            initRound();
        } else {
            alert("KONIEC TURNIEJU! Wyniki: Drużyna 1: " + score1 + " pkt, Drużyna 2: " + score2 + " pkt");
            location.reload();
        }
    }

    function toggleTeam() {
        activeTeam = (activeTeam === 1) ? 2 : 1;
        document.getElementById('team1-box').classList.toggle('active');
        document.getElementById('team2-box').classList.toggle('active');
    }

    document.getElementById('ans-input').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') checkAns();
    });

    initRound();
</script>
</body>
</html>